<div class="card mt-3">

    <div class="card-header">
        <!-- pokemon search bar -->
        <div class="input-group">
            <input class="form-control" type="text" placeholder="Search Pokemon" ng-model="searchPokemon"
                   uib-typeahead="pokemonName for pokemonName in pokemonNames | filter: $viewValue | limitTo: 7"
                   typeahead-on-select="goToPokemon($label)"/>
            <div class="input-group-append">
                <button class="btn btn-dark" ng-click="goToPokemon(searchPokemon)">
                    Go
                </button>
            </div>
        </div>
    </div>

    <div class="card-body" ng-controller="optionsController">
        <div class="row">
            <div class="col-6">
                <h5 class="card-title">Pokemon</h5>
                <span class="d-none">{{updatePokemons()}}</span>
            </div>
            <button class="btn btn-secondary ml-auto mr-3" ng-click="toggleOptions()">
                Options
            </button>
        </div>

        <div ng-show="showOptions">

            <!-- max cp -->
            <div class="input-group mt-3">
                <div class="input-group-prepend">
                    <label class="input-group-text">Max CP:</label>
                </div>
                <input class="form-control" type="number" ng-model="maxCp" readonly>
                <div class="input-group-append">
                    <button class="btn btn-secondary" ng-click="setMaxCp(1500)"
                            ng-class="maxCp <= 1500 ? 'btn-dark' : ''">
                        1500
                    </button>
                </div>
                <div class="input-group-append">
                    <button class="btn btn-secondary" ng-click="setMaxCp(2500)"
                            ng-class="maxCp > 1500 && maxCp <= 2500 ? 'btn-dark' : ''">
                        2500
                    </button>
                </div>
                <div class="input-group-append">
                    <button class="btn btn-secondary" ng-click="setMaxCp(9999)"
                            ng-class="maxCp > 2500 ? 'btn-dark' : ''">
                        None
                    </button>
                </div>
            </div>

            <!-- type filter -->
            <div class="mt-3">
                <label class="form-label mb-0">Type Filters: </label>
                <p class="text-muted mb-3"><small>Click a type twice to filter single-type Pokemon</small></p>
            </div>
            <div class="row">
                <div class="col-1 col-sm-2 col-md-3 col-lg-4"></div>
                <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                    <div class="row">
                        <div ng-repeat="type in types" class="col-2 mt-2"
                             ng-click="updatePokemonTypeFilter(type)">
                            <div class="icon"
                                 ng-class="isPokemonTypeActive(type) ? '{{type.toLowerCase()}}' : 'icon-inactive'">
                                <img ng-src="{{getIconPath(type)}}" data-toggle="tooltip" data-placement="top" title="{{type}}">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-1 col-sm-2 col-md-3 col-lg-4"></div>
            </div>

            <!-- legendary toggle -->
            <div class="btn-toolbar justify-content-between mt-4">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <label class="input-group-text">Include Legendaries</label>
                    </div>
                    <div class="input-group-append">
                        <button class="btn btn-secondary" ng-click="setShowLegendaries(true)"
                                ng-class="showLegendaries ? 'btn-dark' : ''">Yes</button>
                    </div>
                    <div class="input-group-append">
                        <button class="btn btn-secondary" ng-click="setShowLegendaries(false)"
                                ng-class="showLegendaries ? '' : 'btn-dark'">No</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-hover table-fixed"
               st-table="displayedPokemons"
               st-safe-src="pokemons"
               st-persist="pokemonsTable"
               refresh-table>
            <thead>
            <tr>
                <th colspan="3">
                    <input placeholder="Pokemon" class="form-control" type="search"
                           ng-model="searchPokemon" st-search="name" />
                </th>
                <th colspan="2">
                    <input placeholder="ATK" class="form-control" type="search"
                           ng-model="searchAtk" st-search="_atk" />
                </th>
                <th colspan="2">
                    <input placeholder="DEF" class="form-control" type="search"
                           ng-model="searchDef" st-search="_def" />
                </th>
                <th colspan="3">
                    <input placeholder="Max CP" class="form-control" type="search"
                           ng-model="searchMaxCp" st-search="maxCp" />
                </th>
            </tr>
            <tr>
                <th class="sortable" colspan="2" st-sort="name">Pokemon</th>
                <th class="sortable" colspan="2" st-sort="type">Type</th>
                <th class="sortable" st-sort="_atk">ATK</th>
                <th class="sortable" st-sort="_def">DEF</th>
                <th class="sortable" st-sort="_hp">HP</th>
                <th class="sortable" st-sort="_bulk" data-toggle="tooltip" data-placement="top" title="Geometric mean of DEF and HP">Bulk</th>
                <th class="sortable" st-sort="_total" data-toggle="tooltip" data-placement="top" title="Geometric mean of ATK, DEF, and HP">Total</th>
                <th class="sortable" st-sort="_cp">CP</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="pokemon in displayedPokemons track by pokemon.name"
                ng-click="goToPokemon(pokemon.name)">
                <td colspan="2" class="td-overflow">
                    {{pokemon.name}}
                </td>
                <td colspan="2">
                    <div class="row">
                        <div ng-repeat="type in pokemon.type" class="col-4">
                            <div class="icon" ng-class="type.toLowerCase()">
                                <img ng-src="{{getIconPath(type)}}" data-toggle="tooltip" data-placement="top" title="{{type}}">
                            </div>
                        </div>
                    </div>
                </td>
                <td>
                    {{pokemon._atk}}
                </td>
                <td>
                    {{pokemon._def}}
                </td>
                <td>
                    {{pokemon._hp}}
                </td>
                <td>
                    {{pokemon._bulk}}
                </td >
                <td>
                    {{pokemon._total}}
                </td>
                <td>
                    {{pokemon._cp}}
                </td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
                <td class="text-center" colspan="10">
                    <div st-pagination="" st-items-by-page="pageSize" st-displayed-pages="5"></div>
                </td>
            </tr>
            </tfoot>
        </table>
    </div>
</div>
